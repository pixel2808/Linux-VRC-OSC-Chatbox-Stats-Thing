Made this cause there was nothing like this at the time.
Go ahead and use this code for whatever but you are probably better of writing this from scratch cause this is a mess.
